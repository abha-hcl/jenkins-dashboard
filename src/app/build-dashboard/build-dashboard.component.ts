import { Component, OnInit } from '@angular/core';
import { DataService } from '../data.service';
import { FormBuilder, FormControl } from '@angular/forms';
import { Router } from '@angular/router';

@Component({
  selector: 'app-build-dashboard',
  templateUrl: './build-dashboard.component.html',
  styleUrls: ['./build-dashboard.component.css']
})
export class BuildDashboardComponent implements OnInit {
  response: any;
  selectedRegionBuild: any;
  buildFailureData: any;
  initialPageLoad = true;
  buildInfo: any = {};
  failureStages = ['Build', 'Automation Test', 'Build Promtion', 'Store Build and Signing '];
  dashboardForm = this.fb.group({
    buildDropdown: new FormControl('')
  });

  constructor(private dataService: DataService, private fb: FormBuilder, private router: Router) { }

  ngOnInit(): void {
    // this.dataService.getBuildInformation().subscribe(data => {
    this.response = { "_class": "org.jenkinsci.plugins.workflow.job.WorkflowJob", "builds": [{ "_class": "org.jenkinsci.plugins.workflow.job.WorkflowRun", "actions": [{ "_class": "hudson.model.ParametersAction", "parameters": [{ "_class": "hudson.model.StringParameterValue", "name": "REGION", "value": "CL" }] }, { "_class": "hudson.model.CauseAction" }, {}, { "_class": "jenkins.metrics.impl.TimeInQueueAction" }, { "_class": "hudson.plugins.git.util.BuildData" }, { "_class": "hudson.plugins.git.GitTagAction" }, {}, {}, {}, { "_class": "hudson.plugins.git.util.BuildData" }, {}, {}, {}, {}, {}, { "_class": "org.jenkinsci.plugins.pipeline.modeldefinition.actions.RestartDeclarativePipelineAction" }, {}, { "_class": "org.jenkinsci.plugins.workflow.job.views.FlowGraphAction" }, {}, {}, {}, {}], "duration": 103806, "number": 36, "result": "FAILURE" }, { "_class": "org.jenkinsci.plugins.workflow.job.WorkflowRun", "actions": [{}, { "_class": "hudson.model.CauseAction" }, { "_class": "hudson.model.ParametersAction", "parameters": [{ "_class": "hudson.model.StringParameterValue", "name": "REGION", "value": "EU" }] }, { "_class": "jenkins.metrics.impl.TimeInQueueAction" }, {}, { "_class": "hudson.plugins.git.util.BuildData" }, { "_class": "hudson.plugins.git.GitTagAction" }, {}, {}, {}, {}, { "_class": "hudson.plugins.git.util.BuildData" }, {}, { "_class": "org.jenkinsci.plugins.workflow.cps.EnvActionImpl" }, { "_class": "hudson.plugins.git.util.BuildData" }, { "_class": "hudson.plugins.git.util.BuildData" }, { "_class": "hudson.plugins.git.util.BuildData" }, {}, {}, { "_class": "org.jenkinsci.plugins.workflow.support.steps.input.ApproverAction" }, {}, {}, {}, {}, {}, {}, { "_class": "org.jenkinsci.plugins.pipeline.modeldefinition.actions.RestartDeclarativePipelineAction" }, {}, { "_class": "org.jenkinsci.plugins.workflow.job.views.FlowGraphAction" }, {}, {}, {}, {}], "duration": 214399, "number": 35, "result": "SUCCESS" }, { "_class": "org.jenkinsci.plugins.workflow.job.WorkflowRun", "actions": [{ "_class": "hudson.model.ParametersAction", "parameters": [{ "_class": "hudson.model.StringParameterValue", "name": "REGION", "value": "EU" }, { "_class": "hudson.model.StringParameterValue", "name": " SyncVersion", "value": "1.1" }, { "_class": "hudson.model.StringParameterValue", "name": " SyncTag", "value": "" }] }, { "_class": "hudson.model.CauseAction" }, { "_class": "jenkins.metrics.impl.TimeInQueueAction" }, { "_class": "hudson.plugins.git.util.BuildData" }, { "_class": "hudson.plugins.git.GitTagAction" }, {}, {}, {}, { "_class": "hudson.plugins.git.util.BuildData" }, {}, {}, {}, {}, {}, { "_class": "org.jenkinsci.plugins.pipeline.modeldefinition.actions.RestartDeclarativePipelineAction" }, {}, { "_class": "org.jenkinsci.plugins.workflow.job.views.FlowGraphAction" }, {}, {}, {}, {}], "duration": 87440, "number": 34, "result": "FAILURE" }, { "_class": "org.jenkinsci.plugins.workflow.job.WorkflowRun", "actions": [{}, { "_class": "hudson.model.CauseAction" }, { "_class": "hudson.model.ParametersAction", "parameters": [{ "_class": "hudson.model.StringParameterValue", "name": "REGION", "value": "EU" }] }, { "_class": "jenkins.metrics.impl.TimeInQueueAction" }, {}, { "_class": "hudson.plugins.git.util.BuildData" }, { "_class": "hudson.plugins.git.GitTagAction" }, {}, {}, {}, {}, { "_class": "hudson.plugins.git.util.BuildData" }, {}, { "_class": "org.jenkinsci.plugins.workflow.cps.EnvActionImpl" }, { "_class": "hudson.plugins.git.util.BuildData" }, { "_class": "hudson.plugins.git.util.BuildData" }, { "_class": "hudson.plugins.git.util.BuildData" }, {}, {}, {}, {}, {}, {}, {}, { "_class": "org.jenkinsci.plugins.pipeline.modeldefinition.actions.RestartDeclarativePipelineAction" }, {}, { "_class": "org.jenkinsci.plugins.workflow.job.views.FlowGraphAction" }, {}, {}, {}, {}], "duration": 16787, "number": 33, "result": "SUCCESS" }, { "_class": "org.jenkinsci.plugins.workflow.job.WorkflowRun", "actions": [{}, { "_class": "hudson.model.CauseAction" }, { "_class": "hudson.model.ParametersAction", "parameters": [{ "_class": "hudson.model.StringParameterValue", "name": "REGION", "value": "EU" }] }, { "_class": "jenkins.metrics.impl.TimeInQueueAction" }, {}, { "_class": "hudson.plugins.git.util.BuildData" }, { "_class": "hudson.plugins.git.GitTagAction" }, {}, {}, {}, {}, { "_class": "hudson.plugins.git.util.BuildData" }, {}, { "_class": "org.jenkinsci.plugins.workflow.cps.EnvActionImpl" }, { "_class": "hudson.plugins.git.util.BuildData" }, { "_class": "hudson.plugins.git.util.BuildData" }, { "_class": "hudson.plugins.git.util.BuildData" }, {}, {}, {}, {}, {}, {}, {}, { "_class": "org.jenkinsci.plugins.pipeline.modeldefinition.actions.RestartDeclarativePipelineAction" }, {}, { "_class": "org.jenkinsci.plugins.workflow.job.views.FlowGraphAction" }, {}, {}, {}, {}], "duration": 12355, "number": 32, "result": "SUCCESS" }, { "_class": "org.jenkinsci.plugins.workflow.job.WorkflowRun", "actions": [{}, { "_class": "hudson.model.CauseAction" }, { "_class": "hudson.model.ParametersAction", "parameters": [{ "_class": "hudson.model.StringParameterValue", "name": "REGION", "value": "EU" }] }, { "_class": "jenkins.metrics.impl.TimeInQueueAction" }, {}, { "_class": "hudson.plugins.git.util.BuildData" }, { "_class": "hudson.plugins.git.GitTagAction" }, {}, {}, {}, {}, { "_class": "hudson.plugins.git.util.BuildData" }, {}, { "_class": "org.jenkinsci.plugins.workflow.cps.EnvActionImpl" }, { "_class": "hudson.plugins.git.util.BuildData" }, { "_class": "hudson.plugins.git.util.BuildData" }, { "_class": "hudson.plugins.git.util.BuildData" }, {}, {}, {}, {}, {}, {}, {}, { "_class": "org.jenkinsci.plugins.pipeline.modeldefinition.actions.RestartDeclarativePipelineAction" }, {}, { "_class": "org.jenkinsci.plugins.workflow.job.views.FlowGraphAction" }, {}, {}, {}, {}], "duration": 11401, "number": 31, "result": "SUCCESS" }, { "_class": "org.jenkinsci.plugins.workflow.job.WorkflowRun", "actions": [{}, { "_class": "hudson.model.CauseAction" }, { "_class": "hudson.model.ParametersAction", "parameters": [{ "_class": "hudson.model.StringParameterValue", "name": "REGION", "value": "EU" }] }, { "_class": "jenkins.metrics.impl.TimeInQueueAction" }, {}, { "_class": "hudson.plugins.git.util.BuildData" }, { "_class": "hudson.plugins.git.GitTagAction" }, {}, {}, {}, {}, { "_class": "hudson.plugins.git.util.BuildData" }, {}, { "_class": "org.jenkinsci.plugins.workflow.cps.EnvActionImpl" }, { "_class": "hudson.plugins.git.util.BuildData" }, { "_class": "hudson.plugins.git.util.BuildData" }, { "_class": "hudson.plugins.git.util.BuildData" }, {}, {}, {}, {}, {}, {}, {}, { "_class": "org.jenkinsci.plugins.pipeline.modeldefinition.actions.RestartDeclarativePipelineAction" }, {}, { "_class": "org.jenkinsci.plugins.workflow.job.views.FlowGraphAction" }, {}, {}, {}, {}], "duration": 16030, "number": 30, "result": "FAILURE" }, { "_class": "org.jenkinsci.plugins.workflow.job.WorkflowRun", "actions": [{}, { "_class": "hudson.model.CauseAction" }, { "_class": "hudson.model.ParametersAction", "parameters": [{ "_class": "hudson.model.StringParameterValue", "name": "REGION", "value": "EU" }] }, { "_class": "jenkins.metrics.impl.TimeInQueueAction" }, {}, { "_class": "hudson.plugins.git.util.BuildData" }, { "_class": "hudson.plugins.git.GitTagAction" }, {}, {}, {}, {}, { "_class": "hudson.plugins.git.util.BuildData" }, {}, { "_class": "org.jenkinsci.plugins.workflow.cps.EnvActionImpl" }, { "_class": "hudson.plugins.git.util.BuildData" }, { "_class": "hudson.plugins.git.util.BuildData" }, { "_class": "hudson.plugins.git.util.BuildData" }, {}, {}, {}, {}, {}, {}, {}, { "_class": "org.jenkinsci.plugins.pipeline.modeldefinition.actions.RestartDeclarativePipelineAction" }, {}, { "_class": "org.jenkinsci.plugins.workflow.job.views.FlowGraphAction" }, {}, {}, {}, {}], "duration": 17030, "number": 29, "result": "SUCCESS" }, { "_class": "org.jenkinsci.plugins.workflow.job.WorkflowRun", "actions": [{}, { "_class": "hudson.model.CauseAction" }, { "_class": "hudson.model.ParametersAction", "parameters": [{ "_class": "hudson.model.StringParameterValue", "name": "REGION", "value": "EU" }] }, { "_class": "jenkins.metrics.impl.TimeInQueueAction" }, {}, { "_class": "hudson.plugins.git.util.BuildData" }, { "_class": "hudson.plugins.git.GitTagAction" }, {}, {}, {}, {}, { "_class": "hudson.plugins.git.util.BuildData" }, {}, { "_class": "org.jenkinsci.plugins.workflow.cps.EnvActionImpl" }, { "_class": "hudson.plugins.git.util.BuildData" }, { "_class": "hudson.plugins.git.util.BuildData" }, { "_class": "hudson.plugins.git.util.BuildData" }, {}, {}, {}, {}, {}, {}, {}, { "_class": "org.jenkinsci.plugins.pipeline.modeldefinition.actions.RestartDeclarativePipelineAction" }, {}, { "_class": "org.jenkinsci.plugins.workflow.job.views.FlowGraphAction" }, {}, {}, {}, {}], "duration": 104327, "number": 28, "result": "FAILURE" }, { "_class": "org.jenkinsci.plugins.workflow.job.WorkflowRun", "actions": [{}, { "_class": "hudson.model.CauseAction" }, { "_class": "hudson.model.ParametersAction", "parameters": [{ "_class": "hudson.model.StringParameterValue", "name": "REGION", "value": "EU" }] }, {}, { "_class": "jenkins.metrics.impl.TimeInQueueAction" }, {}, { "_class": "hudson.plugins.git.util.BuildData" }, { "_class": "hudson.plugins.git.GitTagAction" }, {}, {}, {}, {}, { "_class": "hudson.plugins.git.util.BuildData" }, {}, { "_class": "org.jenkinsci.plugins.workflow.cps.EnvActionImpl" }, { "_class": "hudson.plugins.git.util.BuildData" }, { "_class": "hudson.plugins.git.util.BuildData" }, { "_class": "hudson.plugins.git.util.BuildData" }, {}, {}, {}, {}, {}, {}, {}, { "_class": "org.jenkinsci.plugins.pipeline.modeldefinition.actions.RestartDeclarativePipelineAction" }, {}, { "_class": "org.jenkinsci.plugins.workflow.job.views.FlowGraphAction" }, {}, {}, {}, {}], "duration": 96210, "number": 27, "result": "FAILURE" }, { "_class": "org.jenkinsci.plugins.workflow.job.WorkflowRun", "actions": [{}, { "_class": "hudson.model.CauseAction" }, { "_class": "hudson.model.ParametersAction", "parameters": [{ "_class": "hudson.model.StringParameterValue", "name": "REGION", "value": "EU" }] }, { "_class": "jenkins.metrics.impl.TimeInQueueAction" }, {}, { "_class": "hudson.plugins.git.util.BuildData" }, { "_class": "hudson.plugins.git.GitTagAction" }, {}, {}, {}, {}, { "_class": "hudson.plugins.git.util.BuildData" }, {}, { "_class": "org.jenkinsci.plugins.workflow.cps.EnvActionImpl" }, { "_class": "hudson.plugins.git.util.BuildData" }, { "_class": "hudson.plugins.git.util.BuildData" }, { "_class": "hudson.plugins.git.util.BuildData" }, {}, {}, {}, {}, {}, {}, {}, { "_class": "org.jenkinsci.plugins.pipeline.modeldefinition.actions.RestartDeclarativePipelineAction" }, {}, { "_class": "org.jenkinsci.plugins.workflow.job.views.FlowGraphAction" }, {}, {}, {}, {}], "duration": 15886, "number": 26, "result": "FAILURE" }, { "_class": "org.jenkinsci.plugins.workflow.job.WorkflowRun", "actions": [{ "_class": "hudson.model.ParametersAction", "parameters": [{ "_class": "hudson.model.StringParameterValue", "name": "REGION", "value": "EU" }] }, { "_class": "hudson.model.CauseAction" }, { "_class": "jenkins.metrics.impl.TimeInQueueAction" }, { "_class": "hudson.plugins.git.util.BuildData" }, { "_class": "hudson.plugins.git.GitTagAction" }, {}, {}, {}, { "_class": "hudson.plugins.git.util.BuildData" }, {}, {}, {}, {}, {}, { "_class": "org.jenkinsci.plugins.pipeline.modeldefinition.actions.RestartDeclarativePipelineAction" }, {}, { "_class": "org.jenkinsci.plugins.workflow.job.views.FlowGraphAction" }, {}, {}, {}, {}], "duration": 2141, "number": 25, "result": "FAILURE" }, { "_class": "org.jenkinsci.plugins.workflow.job.WorkflowRun", "actions": [{ "_class": "hudson.model.ParametersAction", "parameters": [{ "_class": "hudson.model.StringParameterValue", "name": "REGION", "value": "EU" }] }, { "_class": "hudson.model.CauseAction" }, { "_class": "jenkins.metrics.impl.TimeInQueueAction" }, { "_class": "hudson.plugins.git.util.BuildData" }, { "_class": "hudson.plugins.git.GitTagAction" }, {}, {}, {}, {}, {}, {}, {}, { "_class": "org.jenkinsci.plugins.pipeline.modeldefinition.actions.RestartDeclarativePipelineAction" }, {}, { "_class": "org.jenkinsci.plugins.workflow.job.views.FlowGraphAction" }, {}, {}, {}, {}], "duration": 810, "number": 24, "result": "FAILURE" }, { "_class": "org.jenkinsci.plugins.workflow.job.WorkflowRun", "actions": [{ "_class": "hudson.model.ParametersAction", "parameters": [{ "_class": "hudson.model.StringParameterValue", "name": "REGION", "value": "EU" }] }, { "_class": "hudson.model.CauseAction" }, { "_class": "jenkins.metrics.impl.TimeInQueueAction" }, { "_class": "hudson.plugins.git.util.BuildData" }, { "_class": "hudson.plugins.git.GitTagAction" }, {}, {}, {}, {}, {}, {}, {}, { "_class": "org.jenkinsci.plugins.pipeline.modeldefinition.actions.RestartDeclarativePipelineAction" }, {}, { "_class": "org.jenkinsci.plugins.workflow.job.views.FlowGraphAction" }, {}, {}, {}, {}], "duration": 582, "number": 23, "result": "FAILURE" }, { "_class": "org.jenkinsci.plugins.workflow.job.WorkflowRun", "actions": [{ "_class": "hudson.model.ParametersAction", "parameters": [{ "_class": "hudson.model.StringParameterValue", "name": "REGION", "value": "EU" }] }, { "_class": "hudson.model.CauseAction" }, { "_class": "jenkins.metrics.impl.TimeInQueueAction" }, { "_class": "hudson.plugins.git.util.BuildData" }, { "_class": "hudson.plugins.git.GitTagAction" }, {}, {}, {}, {}, {}, {}, {}, { "_class": "org.jenkinsci.plugins.pipeline.modeldefinition.actions.RestartDeclarativePipelineAction" }, {}, { "_class": "org.jenkinsci.plugins.workflow.job.views.FlowGraphAction" }, {}, {}, {}, {}], "duration": 826, "number": 22, "result": "FAILURE" }, { "_class": "org.jenkinsci.plugins.workflow.job.WorkflowRun", "actions": [{}, { "_class": "hudson.model.CauseAction" }, { "_class": "hudson.model.ParametersAction", "parameters": [{ "_class": "hudson.model.StringParameterValue", "name": "REGION", "value": "EU" }] }, { "_class": "jenkins.metrics.impl.TimeInQueueAction" }, {}, {}, {}, {}, {}, { "_class": "org.jenkinsci.plugins.pipeline.modeldefinition.actions.RestartDeclarativePipelineAction" }, {}, { "_class": "org.jenkinsci.plugins.workflow.job.views.FlowGraphAction" }, {}, {}, {}, {}], "duration": 18, "number": 21, "result": "FAILURE" }, { "_class": "org.jenkinsci.plugins.workflow.job.WorkflowRun", "actions": [{ "_class": "hudson.model.ParametersAction", "parameters": [{ "_class": "hudson.model.StringParameterValue", "name": "REGION", "value": "EU" }] }, { "_class": "hudson.model.CauseAction" }, { "_class": "jenkins.metrics.impl.TimeInQueueAction" }, { "_class": "hudson.plugins.git.util.BuildData" }, { "_class": "hudson.plugins.git.GitTagAction" }, {}, {}, {}, {}, {}, {}, {}, { "_class": "org.jenkinsci.plugins.pipeline.modeldefinition.actions.RestartDeclarativePipelineAction" }, {}, { "_class": "org.jenkinsci.plugins.workflow.job.views.FlowGraphAction" }, {}, {}, {}, {}], "duration": 860, "number": 20, "result": "FAILURE" }, { "_class": "org.jenkinsci.plugins.workflow.job.WorkflowRun", "actions": [{ "_class": "hudson.model.ParametersAction", "parameters": [{ "_class": "hudson.model.StringParameterValue", "name": "REGION", "value": "EU" }] }, { "_class": "hudson.model.CauseAction" }, { "_class": "jenkins.metrics.impl.TimeInQueueAction" }, { "_class": "hudson.plugins.git.util.BuildData" }, { "_class": "hudson.plugins.git.GitTagAction" }, {}, {}, {}, {}, {}, {}, {}, { "_class": "org.jenkinsci.plugins.pipeline.modeldefinition.actions.RestartDeclarativePipelineAction" }, {}, { "_class": "org.jenkinsci.plugins.workflow.job.views.FlowGraphAction" }, {}, {}, {}, {}], "duration": 857, "number": 19, "result": "FAILURE" }, { "_class": "org.jenkinsci.plugins.workflow.job.WorkflowRun", "actions": [{ "_class": "hudson.model.ParametersAction", "parameters": [{ "_class": "hudson.model.StringParameterValue", "name": "REGION", "value": "EU" }] }, { "_class": "hudson.model.CauseAction" }, { "_class": "jenkins.metrics.impl.TimeInQueueAction" }, { "_class": "hudson.plugins.git.util.BuildData" }, { "_class": "hudson.plugins.git.GitTagAction" }, {}, {}, {}, {}, {}, {}, {}, { "_class": "org.jenkinsci.plugins.pipeline.modeldefinition.actions.RestartDeclarativePipelineAction" }, {}, { "_class": "org.jenkinsci.plugins.workflow.job.views.FlowGraphAction" }, {}, {}, {}, {}], "duration": 818, "number": 18, "result": "FAILURE" }, { "_class": "org.jenkinsci.plugins.workflow.job.WorkflowRun", "actions": [{ "_class": "hudson.model.ParametersAction", "parameters": [{ "_class": "hudson.model.StringParameterValue", "name": "REGION", "value": "EU" }] }, { "_class": "hudson.model.CauseAction" }, { "_class": "jenkins.metrics.impl.TimeInQueueAction" }, { "_class": "hudson.plugins.git.util.BuildData" }, { "_class": "hudson.plugins.git.GitTagAction" }, {}, {}, {}, {}, {}, {}, {}, { "_class": "org.jenkinsci.plugins.pipeline.modeldefinition.actions.RestartDeclarativePipelineAction" }, {}, { "_class": "org.jenkinsci.plugins.workflow.job.views.FlowGraphAction" }, {}, {}, {}, {}], "duration": 3010, "number": 17, "result": "FAILURE" }, { "_class": "org.jenkinsci.plugins.workflow.job.WorkflowRun", "actions": [{}, { "_class": "hudson.model.CauseAction" }, { "_class": "hudson.model.ParametersAction", "parameters": [{ "_class": "hudson.model.StringParameterValue", "name": "REGION", "value": "EU" }] }, { "_class": "jenkins.metrics.impl.TimeInQueueAction" }, {}, { "_class": "hudson.plugins.git.util.BuildData" }, { "_class": "hudson.plugins.git.GitTagAction" }, {}, {}, {}, {}, { "_class": "hudson.plugins.git.util.BuildData" }, {}, { "_class": "org.jenkinsci.plugins.workflow.cps.EnvActionImpl" }, { "_class": "hudson.plugins.git.util.BuildData" }, { "_class": "hudson.plugins.git.util.BuildData" }, { "_class": "hudson.plugins.git.util.BuildData" }, {}, {}, {}, {}, {}, {}, {}, { "_class": "org.jenkinsci.plugins.pipeline.modeldefinition.actions.RestartDeclarativePipelineAction" }, {}, { "_class": "org.jenkinsci.plugins.workflow.job.views.FlowGraphAction" }, {}, {}, {}, {}], "duration": 8305, "number": 16, "result": "FAILURE" }, { "_class": "org.jenkinsci.plugins.workflow.job.WorkflowRun", "actions": [{}, { "_class": "hudson.model.CauseAction" }, { "_class": "hudson.model.ParametersAction", "parameters": [{ "_class": "hudson.model.StringParameterValue", "name": "REGION", "value": "EU" }] }, { "_class": "jenkins.metrics.impl.TimeInQueueAction" }, {}, { "_class": "hudson.plugins.git.util.BuildData" }, { "_class": "hudson.plugins.git.GitTagAction" }, {}, {}, {}, {}, {}, {}, {}, { "_class": "org.jenkinsci.plugins.pipeline.modeldefinition.actions.RestartDeclarativePipelineAction" }, {}, { "_class": "org.jenkinsci.plugins.workflow.job.views.FlowGraphAction" }, {}, {}, {}, {}], "duration": 2289, "number": 15, "result": "FAILURE" }, { "_class": "org.jenkinsci.plugins.workflow.job.WorkflowRun", "actions": [{}, { "_class": "hudson.model.CauseAction" }, { "_class": "hudson.model.ParametersAction", "parameters": [{ "_class": "hudson.model.StringParameterValue", "name": "REGION", "value": "EU" }] }, { "_class": "jenkins.metrics.impl.TimeInQueueAction" }, {}, { "_class": "hudson.plugins.git.util.BuildData" }, { "_class": "hudson.plugins.git.GitTagAction" }, {}, {}, {}, {}, { "_class": "hudson.plugins.git.util.BuildData" }, {}, { "_class": "org.jenkinsci.plugins.workflow.cps.EnvActionImpl" }, { "_class": "hudson.plugins.git.util.BuildData" }, { "_class": "hudson.plugins.git.util.BuildData" }, { "_class": "hudson.plugins.git.util.BuildData" }, {}, {}, {}, {}, {}, {}, {}, { "_class": "org.jenkinsci.plugins.pipeline.modeldefinition.actions.RestartDeclarativePipelineAction" }, {}, { "_class": "org.jenkinsci.plugins.workflow.job.views.FlowGraphAction" }, {}, {}, {}, {}], "duration": 9345, "number": 14, "result": "FAILURE" }, { "_class": "org.jenkinsci.plugins.workflow.job.WorkflowRun", "actions": [{}, { "_class": "hudson.model.CauseAction" }, { "_class": "hudson.model.ParametersAction", "parameters": [{ "_class": "hudson.model.StringParameterValue", "name": "REGION", "value": "EU" }] }, { "_class": "jenkins.metrics.impl.TimeInQueueAction" }, {}, { "_class": "hudson.plugins.git.util.BuildData" }, { "_class": "hudson.plugins.git.GitTagAction" }, {}, {}, {}, {}, { "_class": "hudson.plugins.git.util.BuildData" }, {}, { "_class": "org.jenkinsci.plugins.workflow.cps.EnvActionImpl" }, { "_class": "hudson.plugins.git.util.BuildData" }, { "_class": "hudson.plugins.git.util.BuildData" }, { "_class": "hudson.plugins.git.util.BuildData" }, {}, {}, {}, {}, {}, {}, {}, { "_class": "org.jenkinsci.plugins.pipeline.modeldefinition.actions.RestartDeclarativePipelineAction" }, {}, { "_class": "org.jenkinsci.plugins.workflow.job.views.FlowGraphAction" }, {}, {}, {}, {}], "duration": 7989, "number": 13, "result": "FAILURE" }, { "_class": "org.jenkinsci.plugins.workflow.job.WorkflowRun", "actions": [{}, { "_class": "hudson.model.CauseAction" }, { "_class": "hudson.model.ParametersAction", "parameters": [{ "_class": "hudson.model.StringParameterValue", "name": "REGION", "value": "EU" }] }, { "_class": "jenkins.metrics.impl.TimeInQueueAction" }, {}, { "_class": "hudson.plugins.git.util.BuildData" }, { "_class": "hudson.plugins.git.GitTagAction" }, {}, {}, {}, {}, {}, {}, {}, { "_class": "org.jenkinsci.plugins.pipeline.modeldefinition.actions.RestartDeclarativePipelineAction" }, {}, { "_class": "org.jenkinsci.plugins.workflow.job.views.FlowGraphAction" }, {}, {}, {}, {}], "duration": 502, "number": 12, "result": "FAILURE" }, { "_class": "org.jenkinsci.plugins.workflow.job.WorkflowRun", "actions": [{}, { "_class": "hudson.model.CauseAction" }, { "_class": "hudson.model.ParametersAction", "parameters": [{ "_class": "hudson.model.StringParameterValue", "name": "REGION", "value": "EU" }] }, { "_class": "jenkins.metrics.impl.TimeInQueueAction" }, {}, { "_class": "hudson.plugins.git.util.BuildData" }, { "_class": "hudson.plugins.git.GitTagAction" }, {}, {}, {}, {}, {}, {}, {}, { "_class": "org.jenkinsci.plugins.pipeline.modeldefinition.actions.RestartDeclarativePipelineAction" }, {}, { "_class": "org.jenkinsci.plugins.workflow.job.views.FlowGraphAction" }, {}, {}, {}, {}], "duration": 566, "number": 11, "result": "FAILURE" }, { "_class": "org.jenkinsci.plugins.workflow.job.WorkflowRun", "actions": [{}, { "_class": "hudson.model.CauseAction" }, { "_class": "hudson.model.ParametersAction", "parameters": [{ "_class": "hudson.model.StringParameterValue", "name": "REGION", "value": "EU" }] }, { "_class": "jenkins.metrics.impl.TimeInQueueAction" }, {}, { "_class": "hudson.plugins.git.util.BuildData" }, { "_class": "hudson.plugins.git.GitTagAction" }, {}, {}, {}, {}, {}, {}, {}, { "_class": "org.jenkinsci.plugins.pipeline.modeldefinition.actions.RestartDeclarativePipelineAction" }, {}, { "_class": "org.jenkinsci.plugins.workflow.job.views.FlowGraphAction" }, {}, {}, {}, {}], "duration": 1708, "number": 10, "result": "FAILURE" }, { "_class": "org.jenkinsci.plugins.workflow.job.WorkflowRun", "actions": [{}, { "_class": "hudson.model.CauseAction" }, { "_class": "hudson.model.ParametersAction", "parameters": [{ "_class": "hudson.model.StringParameterValue", "name": "REGION", "value": "EU" }] }, { "_class": "jenkins.metrics.impl.TimeInQueueAction" }, {}, { "_class": "hudson.plugins.git.util.BuildData" }, { "_class": "hudson.plugins.git.GitTagAction" }, {}, {}, {}, {}, { "_class": "hudson.plugins.git.util.BuildData" }, {}, { "_class": "org.jenkinsci.plugins.workflow.cps.EnvActionImpl" }, { "_class": "hudson.plugins.git.util.BuildData" }, { "_class": "hudson.plugins.git.util.BuildData" }, { "_class": "hudson.plugins.git.util.BuildData" }, {}, {}, {}, {}, {}, {}, {}, { "_class": "org.jenkinsci.plugins.pipeline.modeldefinition.actions.RestartDeclarativePipelineAction" }, {}, { "_class": "org.jenkinsci.plugins.workflow.job.views.FlowGraphAction" }, {}, {}, {}, {}], "duration": 7754, "number": 9, "result": "FAILURE" }, { "_class": "org.jenkinsci.plugins.workflow.job.WorkflowRun", "actions": [{}, { "_class": "hudson.model.CauseAction" }, { "_class": "hudson.model.ParametersAction", "parameters": [{ "_class": "hudson.model.StringParameterValue", "name": "REGION", "value": "EU" }] }, { "_class": "jenkins.metrics.impl.TimeInQueueAction" }, {}, { "_class": "hudson.plugins.git.util.BuildData" }, { "_class": "hudson.plugins.git.GitTagAction" }, {}, {}, {}, {}, { "_class": "hudson.plugins.git.util.BuildData" }, {}, { "_class": "org.jenkinsci.plugins.workflow.cps.EnvActionImpl" }, { "_class": "hudson.plugins.git.util.BuildData" }, { "_class": "hudson.plugins.git.util.BuildData" }, { "_class": "hudson.plugins.git.util.BuildData" }, {}, {}, {}, {}, {}, {}, {}, { "_class": "org.jenkinsci.plugins.pipeline.modeldefinition.actions.RestartDeclarativePipelineAction" }, {}, { "_class": "org.jenkinsci.plugins.workflow.job.views.FlowGraphAction" }, {}, {}, {}, {}], "duration": 8013, "number": 8, "result": "FAILURE" }, { "_class": "org.jenkinsci.plugins.workflow.job.WorkflowRun", "actions": [{}, { "_class": "hudson.model.CauseAction" }, { "_class": "hudson.model.ParametersAction", "parameters": [{ "_class": "hudson.model.StringParameterValue", "name": "REGION", "value": "EU" }] }, { "_class": "jenkins.metrics.impl.TimeInQueueAction" }, {}, { "_class": "hudson.plugins.git.util.BuildData" }, { "_class": "hudson.plugins.git.GitTagAction" }, {}, {}, {}, {}, { "_class": "hudson.plugins.git.util.BuildData" }, {}, { "_class": "org.jenkinsci.plugins.workflow.cps.EnvActionImpl" }, { "_class": "hudson.plugins.git.util.BuildData" }, { "_class": "hudson.plugins.git.util.BuildData" }, { "_class": "hudson.plugins.git.util.BuildData" }, {}, {}, {}, {}, {}, {}, {}, { "_class": "org.jenkinsci.plugins.pipeline.modeldefinition.actions.RestartDeclarativePipelineAction" }, {}, { "_class": "org.jenkinsci.plugins.workflow.job.views.FlowGraphAction" }, {}, {}, {}, {}], "duration": 8176, "number": 7, "result": "FAILURE" }, { "_class": "org.jenkinsci.plugins.workflow.job.WorkflowRun", "actions": [{ "_class": "hudson.model.ParametersAction", "parameters": [{ "_class": "hudson.model.StringParameterValue", "name": "REGION", "value": "EU" }] }, { "_class": "hudson.model.CauseAction" }, { "_class": "jenkins.metrics.impl.TimeInQueueAction" }, { "_class": "hudson.plugins.git.util.BuildData" }, { "_class": "hudson.plugins.git.GitTagAction" }, {}, {}, {}, { "_class": "hudson.plugins.git.util.BuildData" }, {}, {}, {}, { "_class": "org.jenkinsci.plugins.workflow.cps.EnvActionImpl" }, { "_class": "hudson.plugins.git.util.BuildData" }, { "_class": "hudson.plugins.git.util.BuildData" }, { "_class": "hudson.plugins.git.util.BuildData" }, {}, {}, {}, {}, {}, {}, {}, { "_class": "org.jenkinsci.plugins.pipeline.modeldefinition.actions.RestartDeclarativePipelineAction" }, {}, { "_class": "org.jenkinsci.plugins.workflow.job.views.FlowGraphAction" }, {}, {}, {}, {}], "duration": 9533, "number": 6, "result": "FAILURE" }, { "_class": "org.jenkinsci.plugins.workflow.job.WorkflowRun", "actions": [{ "_class": "hudson.model.ParametersAction", "parameters": [{ "_class": "hudson.model.StringParameterValue", "name": "REGION", "value": "EU" }] }, { "_class": "hudson.model.CauseAction" }, { "_class": "jenkins.metrics.impl.TimeInQueueAction" }, { "_class": "hudson.plugins.git.util.BuildData" }, { "_class": "hudson.plugins.git.GitTagAction" }, {}, {}, {}, { "_class": "hudson.plugins.git.util.BuildData" }, {}, {}, {}, { "_class": "org.jenkinsci.plugins.workflow.cps.EnvActionImpl" }, { "_class": "hudson.plugins.git.util.BuildData" }, { "_class": "hudson.plugins.git.util.BuildData" }, { "_class": "hudson.plugins.git.util.BuildData" }, {}, {}, {}, {}, {}, {}, {}, { "_class": "org.jenkinsci.plugins.pipeline.modeldefinition.actions.RestartDeclarativePipelineAction" }, {}, { "_class": "org.jenkinsci.plugins.workflow.job.views.FlowGraphAction" }, {}, {}, {}, {}], "duration": 15431, "number": 5, "result": "FAILURE" }, { "_class": "org.jenkinsci.plugins.workflow.job.WorkflowRun", "actions": [{ "_class": "hudson.model.ParametersAction", "parameters": [{ "_class": "hudson.model.StringParameterValue", "name": "REGION", "value": "EU" }] }, { "_class": "hudson.model.CauseAction" }, { "_class": "jenkins.metrics.impl.TimeInQueueAction" }, { "_class": "hudson.plugins.git.util.BuildData" }, { "_class": "hudson.plugins.git.GitTagAction" }, {}, {}, {}, { "_class": "hudson.plugins.git.util.BuildData" }, {}, {}, {}, {}, {}, { "_class": "org.jenkinsci.plugins.pipeline.modeldefinition.actions.RestartDeclarativePipelineAction" }, {}, { "_class": "org.jenkinsci.plugins.workflow.job.views.FlowGraphAction" }, {}, {}, {}, {}], "duration": 133955, "number": 4, "result": "FAILURE" }, { "_class": "org.jenkinsci.plugins.workflow.job.WorkflowRun", "actions": [{ "_class": "hudson.model.ParametersAction", "parameters": [{ "_class": "hudson.model.StringParameterValue", "name": "REGION", "value": "EU" }] }, { "_class": "hudson.model.CauseAction" }, { "_class": "jenkins.metrics.impl.TimeInQueueAction" }, { "_class": "hudson.plugins.git.util.BuildData" }, { "_class": "hudson.plugins.git.GitTagAction" }, {}, {}, {}, { "_class": "hudson.plugins.git.util.BuildData" }, {}, {}, {}, { "_class": "org.jenkinsci.plugins.workflow.cps.EnvActionImpl" }, { "_class": "hudson.plugins.git.util.BuildData" }, { "_class": "hudson.plugins.git.util.BuildData" }, { "_class": "hudson.plugins.git.util.BuildData" }, {}, {}, { "_class": "jenkins.model.InterruptedBuildAction" }, {}, {}, { "_class": "jenkins.model.InterruptedBuildAction" }, {}, {}, {}, {}, { "_class": "org.jenkinsci.plugins.pipeline.modeldefinition.actions.RestartDeclarativePipelineAction" }, {}, { "_class": "org.jenkinsci.plugins.workflow.job.views.FlowGraphAction" }, {}, {}, {}, {}], "duration": 179490812, "number": 3, "result": "ABORTED" }, { "_class": "org.jenkinsci.plugins.workflow.job.WorkflowRun", "actions": [{}, { "_class": "hudson.model.CauseAction" }, { "_class": "hudson.model.ParametersAction", "parameters": [{ "_class": "hudson.model.StringParameterValue", "name": "REGION", "value": "EU" }] }, {}, { "_class": "jenkins.metrics.impl.TimeInQueueAction" }, {}, { "_class": "hudson.plugins.git.util.BuildData" }, { "_class": "hudson.plugins.git.GitTagAction" }, {}, {}, {}, {}, { "_class": "hudson.plugins.git.util.BuildData" }, {}, { "_class": "org.jenkinsci.plugins.workflow.cps.EnvActionImpl" }, { "_class": "hudson.plugins.git.util.BuildData" }, { "_class": "hudson.plugins.git.util.BuildData" }, { "_class": "hudson.plugins.git.util.BuildData" }, {}, {}, { "_class": "org.jenkinsci.plugins.workflow.support.steps.input.ApproverAction" }, {}, {}, {}, {}, {}, {}, { "_class": "org.jenkinsci.plugins.pipeline.modeldefinition.actions.RestartDeclarativePipelineAction" }, {}, { "_class": "org.jenkinsci.plugins.workflow.job.views.FlowGraphAction" }, {}, {}, {}, {}], "duration": 2641927, "number": 2, "result": "SUCCESS" }, { "_class": "org.jenkinsci.plugins.workflow.job.WorkflowRun", "actions": [{ "_class": "hudson.model.ParametersAction", "parameters": [{ "_class": "hudson.model.StringParameterValue", "name": "REGION", "value": "EU" }] }, { "_class": "hudson.model.CauseAction" }, { "_class": "jenkins.metrics.impl.TimeInQueueAction" }, { "_class": "hudson.plugins.git.util.BuildData" }, { "_class": "hudson.plugins.git.GitTagAction" }, {}, {}, {}, { "_class": "hudson.plugins.git.util.BuildData" }, {}, {}, {}, { "_class": "org.jenkinsci.plugins.workflow.cps.EnvActionImpl" }, {}, {}, {}, {}, {}, {}, {}, { "_class": "org.jenkinsci.plugins.pipeline.modeldefinition.actions.RestartDeclarativePipelineAction" }, {}, { "_class": "org.jenkinsci.plugins.workflow.job.views.FlowGraphAction" }, {}, {}, {}, {}], "duration": 150410, "number": 1, "result": "FAILURE" }] };
    // });
    this.dataService.getBuildInformation().subscribe((response) => {
    console.log('response is', response);
    this.response = response;
    })
  }

  onSelect() {
    this.initialPageLoad = false;
    this.buildFailureData = null;
    this.buildInfo = {};
    let selectedRegion = this.dashboardForm.controls.buildDropdown.value;
    this.selectedRegionBuild = this.response.builds.filter(build => {
      let isBuildPresent = build.actions.some((action: any) => {
        if (action.parameters && action.parameters[0].value === selectedRegion) {
          return action;
        }
      });
      if (isBuildPresent) {
        return build;
      }
      })[0];
      console.log('this.selectedRegion build is', this.selectedRegionBuild);

    if (this.selectedRegionBuild && this.selectedRegionBuild.result) {
      switch (this.selectedRegionBuild.result) {
        case 'SUCCESS':
          this.buildInfo.statusValue = 'SUCCESS';
	  this.buildInfo.status = true;
	  this.buildInfo.number = this.selectedRegionBuild.number;
          break;
        case 'FAILURE':
          this.buildInfo.statusValue = 'FAILURE';
	  this.buildInfo.status = false;
	  this.buildInfo.number = this.selectedRegionBuild.number;
	  this.fetchFailureInformation(this.buildInfo.number);
          break;
      }
      this.buildInfo.duration = this.selectedRegionBuild.duration? (this.selectedRegionBuild.duration/6000).toFixed(2) + 'mins': 'N/A';
      this.buildInfo.buildVersion = '1.0';
      this.buildInfo.buildName = 'Harrow';
      } else {
      	this.selectedRegionBuild= null;
      }
    /* if (!this.buildInfo.status && this.buildInfo.status !== undefined && this.buildInfo.status !== null) {
      this.buildFailureData = { "_links": { "self": { "href": "/job/mobileBuild/10/wfapi/describe" } }, "id": "10", "name": "#10", "status": "FAILED", "startTimeMillis": 1597990339875, "endTimeMillis": 1597990360296, "durationMillis": 20421, "queueDurationMillis": 6, "pauseDurationMillis": 0, "stages": [{ "_links": { "self": { "href": "/job/mobileBuild/10/execution/node/6/wfapi/describe" } }, "id": "6", "name": "Checkout", "execNode": "", "status": "SUCCESS", "startTimeMillis": 1597990344732, "durationMillis": 377, "pauseDurationMillis": 0 }, { "_links": { "self": { "href": "/job/mobileBuild/10/execution/node/11/wfapi/describe" } }, "id": "11", "name": "Set Pipeline", "execNode": "", "status": "SUCCESS", "startTimeMillis": 1597990345133, "durationMillis": 1233, "pauseDurationMillis": 0 }, { "_links": { "self": { "href": "/job/mobileBuild/10/execution/node/23/wfapi/describe" } }, "id": "23", "name": "Unit Test", "execNode": "", "status": "SUCCESS", "startTimeMillis": 1597990346388, "durationMillis": 5512, "pauseDurationMillis": 0 }, { "_links": { "self": { "href": "/job/mobileBuild/10/execution/node/28/wfapi/describe" } }, "id": "28", "name": "Sonar Analysis", "execNode": "", "status": "SUCCESS", "startTimeMillis": 1597990351928, "durationMillis": 310, "pauseDurationMillis": 0 }, { "_links": { "self": { "href": "/job/mobileBuild/10/execution/node/33/wfapi/describe" } }, "id": "33", "name": "Sonar QualityGate Check", "execNode": "", "status": "SUCCESS", "startTimeMillis": 1597990352260, "durationMillis": 305, "pauseDurationMillis": 0 }, { "_links": { "self": { "href": "/job/mobileBuild/10/execution/node/38/wfapi/describe" } }, "id": "38", "name": "Build", "execNode": "", "status": "SUCCESS", "startTimeMillis": 1597990352586, "durationMillis": 5508, "pauseDurationMillis": 0 }, { "_links": { "self": { "href": "/job/mobileBuild/10/execution/node/43/wfapi/describe" } }, "id": "43", "name": "Prepare Package", "execNode": "", "status": "SUCCESS", "startTimeMillis": 1597990358115, "durationMillis": 310, "pauseDurationMillis": 0 }, { "_links": { "self": { "href": "/job/mobileBuild/10/execution/node/48/wfapi/describe" } }, "id": "48", "name": "Deploy build", "execNode": "", "status": "SUCCESS", "startTimeMillis": 1597990358448, "durationMillis": 478, "pauseDurationMillis": 0 }, { "_links": { "self": { "href": "/job/mobileBuild/10/execution/node/69/wfapi/describe" } }, "id": "69", "name": "Git Tag", "execNode": "", "status": "SUCCESS", "startTimeMillis": 1597990358950, "durationMillis": 309, "pauseDurationMillis": 0 }, { "_links": { "self": { "href": "/job/mobileBuild/10/execution/node/74/wfapi/describe" } }, "id": "74", "name": "Automation Test", "execNode": "", "status": "NOT_EXECUTED", "startTimeMillis": 1597990359281, "durationMillis": 102, "pauseDurationMillis": 0 }, { "_links": { "self": { "href": "/job/mobileBuild/10/execution/node/78/wfapi/describe" } }, "id": "78", "name": "Publish Reports", "execNode": "", "status": "FAILED", "error": { "message": "script returned exit code 7", "type": "hudson.AbortException" }, "startTimeMillis": 1597990359408, "durationMillis": 369, "pauseDurationMillis": 0 }, { "_links": { "self": { "href": "/job/mobileBuild/10/execution/node/83/wfapi/describe" } }, "id": "83", "name": "Build Promtion", "execNode": "", "status": "FAILED", "error": { "message": "script returned exit code 7", "type": "hudson.AbortException" }, "startTimeMillis": 1597990359808, "durationMillis": 88, "pauseDurationMillis": 0 }, { "_links": { "self": { "href": "/job/mobileBuild/10/execution/node/87/wfapi/describe" } }, "id": "87", "name": "Version Check", "execNode": "", "status": "FAILED", "error": { "message": "script returned exit code 7", "type": "hudson.AbortException" }, "startTimeMillis": 1597990359925, "durationMillis": 67, "pauseDurationMillis": 0 }, { "_links": { "self": { "href": "/job/mobileBuild/10/execution/node/91/wfapi/describe" } }, "id": "91", "name": "Store Build and Signing ", "execNode": "", "status": "FAILED", "error": { "message": "script returned exit code 7", "type": "hudson.AbortException" }, "startTimeMillis": 1597990360025, "durationMillis": 54, "pauseDurationMillis": 0 }, { "_links": { "self": { "href": "/job/mobileBuild/10/execution/node/95/wfapi/describe" } }, "id": "95", "name": "Deploy to Beta", "execNode": "", "status": "FAILED", "error": { "message": "script returned exit code 7", "type": "hudson.AbortException" }, "startTimeMillis": 1597990360107, "durationMillis": 39, "pauseDurationMillis": 0 }] };
      this.selectedRegionBuild = {};
      for (let stage of this.buildFailureData.stages) {
        if (this.failureStages.indexOf(stage.name) > -1) {
          this.selectedRegionBuild[stage.name] = stage.status;
        }
      }     
      console.log('this.filteredData in failure is', this.selectedRegionBuild);
      }*/
  }

  checkBuildStatus(result) {
    if (result === 'SUCCESS') {
      return 'text-success';
    } else if (result === 'FAILURE' || result === 'FAILED') {
      return 'text-danger';
    } else if(result === 'NOT_EXECUTED') {
      return 'text-orange';
    }
    }
      fetchFailureInformation(buildNumber) {
          this.dataService.getBuildFailureInformation(buildNumber).subscribe((data) => {
	  console.log('data is', data);                 
	  this.buildFailureData = data;
	   this.selectedRegionBuild = {};
	         for (let stage of this.buildFailureData.stages) {
		         if (this.failureStages.indexOf(stage.name) > -1) {
			           this.selectedRegionBuild[stage.name] = stage.status;
				           }
					         }     
						       console.log('this.filteredData in failure is', this.selectedRegionBuild);

		      });
		        }

  refreshData() {
    this.router.navigateByUrl('/', { skipLocationChange: true }).then(() => {
      this.router.navigate(['dashboard']);
    });
  }
}
